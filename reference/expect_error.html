<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Expectation: does code throw error or other condition? — expect_error • testthat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Expectation: does code throw error or other condition? — expect_error" />
<meta property="og:description" content="expect_error() and expect_condition() check that code throws an error
or condition with a message that matches regexp, or a class that inherits
from class. See below for more details." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">testthat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.1.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/custom-expectation.html">Custom expectations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/04/testthat-2-1-0/">Version 2.1.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2017/12/testthat-2-0-0/">Version 2.0.0</a>
    </li>
    <li>
      <a href="https://blog.rstudio.com/2016/04/29/testthat-1-0-0/">Version 1.0.0</a>
    </li>
    <li>
      <a href="https://blog.rstudio.com/2015/05/29/testthat-0-10-0/">Version 0.10.0</a>
    </li>
    <li>
      <a href="https://blog.rstudio.com/2014/09/23/testthat-0-9/">Version 0.9.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/testthat">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Expectation: does code throw error or other condition?</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/testthat/blob/master/R/expect-condition.R'><code>R/expect-condition.R</code></a></small>
    <div class="hidden name"><code>expect_error.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>expect_error()</code> and <code>expect_condition()</code> check that code throws an error
or condition with a message that matches <code>regexp</code>, or a class that inherits
from <code>class</code>. See below for more details.</p>
    </div>

    <pre class="usage"><span class='fu'>expect_error</span>(<span class='no'>object</span>, <span class='kw'>regexp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>class</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>info</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>label</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>expect_condition</span>(<span class='no'>object</span>, <span class='kw'>regexp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>class</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>,
  <span class='kw'>info</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>label</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Object to test.</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href='quasi_label.html'>quasi_label</a> for more details.</p></td>
    </tr>
    <tr>
      <th>regexp</th>
      <td><p>Regular expression to test against.</p><ul>
<li><p>A character vector giving a regular expression that must match the
error message.</p></li>
<li><p>If <code>NULL</code>, the default, asserts that there should be a error,
but doesn't test for a specific value.</p></li>
<li><p>If <code>NA</code>, asserts that there should be no errors.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>class</th>
      <td><p>Instead of supplying a regular expression, you can also supply
a class name. This is useful for "classed" conditions.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code>expect_match</code></p><dl class='dl-horizontal'>
  <dt>all</dt><dd><p>Should all elements of actual value match <code>regexp</code> (TRUE),
or does only one need to match (FALSE)</p></dd>
  <dt>perl</dt><dd><p>logical.  Should Perl-compatible regexps be used?</p></dd>
  <dt>fixed</dt><dd><p>logical.  If <code>TRUE</code>, <code>pattern</code> is a string to be
    matched as is.  Overrides all conflicting arguments.</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>info</th>
      <td><p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href='quasi_label.html'>quasi_label</a>.</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>Used to customise failure messages. For expert use only.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>regexp = NA</code>, the value of the first argument; otherwise
the captured condition.</p>
    <h2 class="hasAnchor" id="testing-message-vs-class"><a class="anchor" href="#testing-message-vs-class"></a>Testing <code>message</code> vs <code>class</code></h2>

    

<p>When checking that code generates an error, it's important to check that the
error is the one you expect. There are two ways to do this. The first
way is the simplest: you just provide a <code>regexp</code> that match some fragment
of the error message. This is easy, but fragile, because the test will
fail if the error message changes (even if its the same error).</p>
<p>A more robust way is to test for the class of the error, if it has one.
You can learn more about custom conditions at
<a href='https://adv-r.hadley.nz/conditions.html#custom-conditions'>https://adv-r.hadley.nz/conditions.html#custom-conditions</a>, but in
short, errors are S3 classes and you can generate a custom class and check
for it using <code>class</code> instead of <code>regexp</code>. Because this is a more reliable
check, you <code>expect_error()</code> will warn if the error has a custom class but
you are testing the message. Eliminate the warning by using <code>class</code> instead
of <code>regexp</code>. Alternatively, if you think the warning is a false positive,
use <code>class = "error"</code> to suppress it for any input.</p>
<p>If you are using <code>expect_error()</code> to check that an error message is
formatted in such a way that it makes sense to a human, we now recommend
using <code><a href='verify_output.html'>verify_output()</a></code> instead.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other expectations: <code><a href='comparison-expectations.html'>comparison-expectations</a></code>,
  <code><a href='equality-expectations.html'>equality-expectations</a></code>,
  <code><a href='expect_length.html'>expect_length</a></code>, <code><a href='expect_match.html'>expect_match</a></code>,
  <code><a href='expect_message.html'>expect_message</a></code>, <code><a href='expect_named.html'>expect_named</a></code>,
  <code><a href='expect_null.html'>expect_null</a></code>, <code><a href='expect_output.html'>expect_output</a></code>,
  <code><a href='expect_silent.html'>expect_silent</a></code>,
  <code><a href='inheritance-expectations.html'>inheritance-expectations</a></code>,
  <code><a href='logical-expectations.html'>logical-expectations</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>() <span class='fu'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span>(<span class='st'>"My error!"</span>)
<span class='fu'>expect_error</span>(<span class='fu'>f</span>())
<span class='fu'>expect_error</span>(<span class='fu'>f</span>(), <span class='st'>"My error!"</span>)

<span class='co'># You can use the arguments of grepl to control the matching</span>
<span class='fu'>expect_error</span>(<span class='fu'>f</span>(), <span class='st'>"my error!"</span>, <span class='kw'>ignore.case</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># If you are working with classed conditions, it's better to test for</span>
<span class='co'># the class name, rather than the error message (which may change over time)</span>
<span class='no'>custom_err</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>() {
  <span class='kw pkg'>rlang</span><span class='kw ns'>::</span><span class='fu'><a href='https://rlang.r-lib.org/reference/abort.html'>abort</a></span>(<span class='st'>"A special error"</span>, <span class='kw'>.subclass</span> <span class='kw'>=</span> <span class='st'>"testthat_special"</span>)
}
<span class='fu'>expect_error</span>(<span class='fu'>custom_err</span>(), <span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>"testthat_special"</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#testing-message-vs-class">Testing <code>message</code> vs <code>class</code></a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>, <a href='https://www.rstudio.com'><img src='https://www.tidyverse.org/rstudio-logo.svg' alt='RStudio' height='24' /></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


